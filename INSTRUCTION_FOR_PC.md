# üìù –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –ù–ê –ü–ö

**–î–∞—Ç–∞:** 2026-02-26
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–µ–ø–ª–æ–∏—Ç—Å—è**

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û –°–ï–ì–û–î–ù–Ø (2026-02-26)

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:

1. **‚úÖ –ë—ç–∫–µ–Ω–¥ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ PostgreSQL**
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ Prisma —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
   - –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã: `users`, `orders`, `subscriptions`, `payments`, `order_items`
   - Railway: `https://biomark-web-production.up.railway.app`

2. **‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ PostgreSQL
   - JWT —Ç–æ–∫–µ–Ω—ã –≤—ã–¥–∞—é—Ç—Å—è
   - sessionStorage —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

3. **‚úÖ –õ–æ–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT
   - –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

4. **‚úÖ API endpoints –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã**
   - `/api/auth/*` ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - `/api/users/*` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å
   - `/api/orders/*` ‚Äî –∑–∞–∫–∞–∑—ã
   - `/api/subscriptions/*` ‚Äî –ø–æ–¥–ø–∏—Å–∫–∏
   - `/api/payments/*` ‚Äî –ø–ª–∞—Ç–µ–∂–∏

5. **üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã**
   - `user/profile` ‚Üí `users/profile` (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
   - `user/orders` ‚Üí `orders`
   - `user/subscription` ‚Üí `subscriptions`
   - `payments/methods` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω endpoint
   - `api.js` ‚Äî null handling –∏—Å–ø—Ä–∞–≤–ª–µ–Ω

---

## üöÄ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| **–ë—ç–∫–µ–Ω–¥ (Railway)** | ‚úÖ Deployed | `https://biomark-web-production.up.railway.app` |
| **PostgreSQL** | ‚úÖ Online | –ü–æ–¥–∫–ª—é—á—ë–Ω, –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã |
| **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (Vercel)** | ‚úÖ Deployed | `https://biomark-web.vercel.app` |
| **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL |
| **–õ–æ–≥–∏–Ω** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | JWT + sessionStorage |
| **–ü—Ä–æ—Ñ–∏–ª—å** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ API |
| **–ó–∞–∫–∞–∑—ã** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ |
| **–ü–æ–¥–ø–∏—Å–∫–∏** | ‚ö†Ô∏è **400 Bad Request** | –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π plan |
| **–ü–ª–∞—Ç–µ–∂–∏** | ‚ö†Ô∏è Mock Stripe | –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |

---

## üî¥ –ü–†–û–ë–õ–ï–ú–´ –î–õ–Ø –†–ï–®–ï–ù–ò–Ø

### 1. –ü–æ–¥–ø–∏—Å–∫–∞ ‚Äî 400 Bad Request

**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–∏ –æ–ø–ª–∞—Ç–µ –ø–æ–¥–ø–∏—Å–∫–∏ –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Zod

**–û—à–∏–±–∫–∞:**
```
Invalid option: expected one of "1month"|"3months"|"1year"
```

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:**
- –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ `checkout.html`
- –õ–æ–≥–∏ Railway –ø–æ—Å–ª–µ `POST /api/subscriptions`

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ checkout
2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –≤—ã–≤–æ–¥–∏—Ç `createSubscription called with planId:`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `planId` —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ `"1month"` –∞ –Ω–µ `undefined`

**–§–∞–π–ª—ã:**
- `src/js/services/subscriptionService.js` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥
- `server/src/routes/subscriptions.js` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è Zod
- `server/src/utils/validators.js` ‚Äî `createSubscriptionSchema`

---

## üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (—Å–¥–µ–ª–∞—Ç—å –∑–∞–≤—Ç—Ä–∞)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É**
   - –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å `planId` –Ω–∞ checkout
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ PostgreSQL

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª**
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –õ–æ–≥–∏–Ω ‚Üí –ü—Ä–æ—Ñ–∏–ª—å ‚Üí –ü–æ–¥–ø–∏—Å–∫–∞ ‚Üí –û–ø–ª–∞—Ç–∞

### üü° –í–∞–∂–Ω–æ (—É–ª—É—á—à–µ–Ω–∏—è)

3. **–î–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ-—Ä–µ–∂–∏–º –æ–±—Ä–∞—Ç–Ω–æ** (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)
   - Vercel: `VITE_ENABLE_DEMO_LOGIN=true`
   - –ò–ª–∏ —É–¥–∞–ª–∏—Ç—å –¥–µ–º–æ-–∫—Ä–µ–¥—ã –∏–∑ –∫–æ–¥–∞

4. **–ü–æ—á–∏–Ω–∏—Ç—å –¥–∞—Ç—ã**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å timezone Europe/Prague
   - formatDistanceToNow –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

5. **–î–æ–±–∞–≤–∏—Ç—å loading states**
   - Skeleton loaders –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å
   - Spinners –Ω–∞ –∫–Ω–æ–ø–∫–∏

### üü¢ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ø–æ—Ç–æ–º)

6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - Sentry –¥–ª—è –æ—à–∏–±–æ–∫
   - –õ–æ–≥–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

7. **–¢–µ—Å—Ç—ã**
   - Vitest —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   - –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ò –û–ö–†–£–ñ–ï–ù–ò–Ø

### Vercel (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥):
```
VITE_API_MODE=real
VITE_API_URL=https://biomark-web-production.up.railway.app
VITE_ENABLE_DEMO_LOGIN=false
VITE_STRIPE_PUBLIC_KEY=pk_test_...
```

### Railway (–±—ç–∫–µ–Ω–¥):
```
DATABASE_URL=postgresql://...
JWT_SECRET=...
FRONTEND_URL=https://biomark-web.vercel.app
NODE_ENV=production
PORT=8080
```

---

## üìù –ö–û–ú–ê–ù–î–´

### –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
# –§—Ä–æ–Ω—Ç–µ–Ω–¥
npm run dev

# –ë—ç–∫–µ–Ω–¥ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ)
cd server
npm run dev
```

### –î–µ–ø–ª–æ–π:
```bash
# –ü—Ä–æ—Å—Ç–æ –ø—É—à –≤ main
git add .
git commit -m "fix: ..."
git push
```

Vercel –∏ Railway –∑–∞–¥–µ–ø–ª–æ—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API:
```bash
# Health check
curl https://biomark-web-production.up.railway.app/health

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
curl -X POST https://biomark-web-production.up.railway.app/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"test123","fullname":"Test","role":"buyer"}'
```

---

## üóÇ –§–ê–ô–õ–´

### –û—Å–Ω–æ–≤–Ω—ã–µ:
- `INSTRUCTION_FOR_PC.md` ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª
- `server/` ‚Äî –±—ç–∫–µ–Ω–¥ (Node.js + Prisma + PostgreSQL)
- `src/` ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (Vite + Vanilla JS)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `.env` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
- `.env.example` ‚Äî —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- `railway.toml` / `nixpacks.toml` ‚Äî –∫–æ–Ω—Ñ–∏–≥ Railway
- `vercel.json` ‚Äî –∫–æ–Ω—Ñ–∏–≥ Vercel

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `SECURITY.md` ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- `CODE_REVIEW_CHECKLIST.md` ‚Äî —á–µ–∫–ª–∏—Å—Ç —Ä–µ–≤—å—é (—É—Å—Ç–∞—Ä–µ–ª, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
- `PRE_BACKEND_CHECKLIST.md` ‚Äî –ø–ª–∞–Ω (—É—Å—Ç–∞—Ä–µ–ª, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
- `DEPLOY_STATUS.md` ‚Äî —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è (–∞–∫—Ç—É–∞–ª–µ–Ω)
- `Fix_registration.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ñ–∏–∫—Å–∞ (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)

---

## üéØ –¶–ï–õ–¨ –ù–ê –ó–ê–í–¢–†–ê

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É (400 Bad Request)
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é –æ–ø–ª–∞—Ç—É
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∞ –≤ PostgreSQL
4. ‚úÖ –°–¥–µ–ª–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –æ–ø–ª–∞—Ç–∞

---

## üìû –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

1. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway:**
   - Railway Dashboard ‚Üí `biomark-web` ‚Üí Deployments ‚Üí View Logs

2. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Vercel:**
   - Vercel Dashboard ‚Üí `biomark-web` ‚Üí Deployments ‚Üí View Build Logs

3. **–ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
   - F12 ‚Üí Console
   - F12 ‚Üí Network ‚Üí –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø—Ä–æ—Å—ã

4. **–ü—Ä–æ–≤–µ—Ä—å PostgreSQL:**
   - Railway Dashboard ‚Üí Postgres ‚Üí Data

---

**–£–¥–∞—á–∏! –í—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è!** üöÄ
